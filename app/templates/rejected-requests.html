<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Request Report</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.css"/>
    <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.js"></script>
</head>
<body>
{% include "partials/navigation-bar.html" %}

<h1>{{get_term_name(current_user.current_term) ~ " Request Report"}}</h1>

{% if valid_requests %}
<h3>Accepted Requests</h3>
<table id="accepted-requests" class="table table-striped">
    <thead>
    <tr>
        <th>Course ID</th>
        <th>Course Name</th>
        <th>Student ID</th>
        <th>Student Name</th>
    </tr>
    </thead>
    <tbody>
    {% for row in valid_requests %}
        <tr class="alert alert-success">
            <td>{{ row.course_id }}</td>
            <td>{{ row.course_name }}</td>
            <td>{{ row.student_id }}</td>
            <td>{{ row.student_name }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-danger" role="alert">
  <strong>Oh no!</strong> No requests were accepted.
</div>
{% endif %}

<h3>Rejected Requests</h3>

{% if reject_dict %}
<table id="rejected-requests" class="table table-striped">
    <thead>
    <tr>
        <th>Course ID</th>
        <th>Course Name</th>
        <th>Student ID</th>
        <th>Student Name</th>
        <th>Reason for Rejection</th>
    </tr>
    </thead>
    <tbody>
    {% for (student_id, course_id), info in reject_dict|dictsort %}
    <tr class="alert alert-danger">
        <td>{{ course_id }}</td>
        <td>{{ info.course_name }}</td>
        <td>{{ student_id }}</td>
        <td>{{ info.student_name }}</td>
        <td>
            <ul>
                {% if info.no_instructor %}
                <ol>No instructor</ol>
                {% endif %}
                {% if info.missing_prereqs is defined %}
                <strong>Missing Prerequisites</strong>
                    {% for prereq in info.missing_prereqs%}
                        <ol>{{prereq.name}}</ol>
                    {% endfor %}
                {% endif %}

            </ul>
        </td>
    </tr>
    {% endfor %}

    </tbody>
</table>
{% else %}
<div class="alert alert-success" role="alert">
  <strong>Good job!</strong> All requests were fulfilled!
</div>
{% endif %}

<form action="/rejected-requests" method="POST">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/> <br>
    <button type="submit" id="next-term-button"> Move on to Next Term </button>
</form>
</body>
</html>